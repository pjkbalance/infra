# Database Connection Settings
listen_addresses = '*'  # 允许监听所有地址，生产环境建议仅监听特定地址
port = 5432

# Resource Management
shared_buffers = 128MB  # 默认内存缓存大小，调整为系统总内存的 25%-40%
work_mem = 4MB          # 每个查询分配的内存大小
maintenance_work_mem = 64MB  # 维护任务（如索引重建）所用的内存

# Logging Settings
logging_collector = on
log_directory = '/var/lib/postgresql/data/log'  # 确保此路径在挂载的数据卷内
log_filename = 'postgresql.log'
log_statement = 'all'  # 可选: 'none', 'ddl', 'mod', 'all'
log_min_duration_statement = 500  # 记录执行时间超过 500ms 的查询

# Connections and Authentication
max_connections = 100  # 最大并发连接数
password_encryption = scram-sha-256  # 更安全的密码加密方式

# File Locations
data_directory = '/var/lib/postgresql/data'
hba_file = '/etc/postgresql/pg_hba.conf'  # 指定自定义的 pg_hba.conf 文件
ident_file = '/etc/postgresql/pg_ident.conf'

# Performance Tweaks
effective_cache_size = 512MB  # 假设系统内存充足，这个值可以更大
checkpoint_timeout = 10min
default_statistics_target = 100
wal_buffers = 16MB